import pandas as pd
import tkinter as tk
from tkinter import filedialog

# Create Tkinter root window (hidden)
root = tk.Tk()
root.withdraw()

# Ask user to select input CSV files
input_files = filedialog.askopenfilenames(
    title="Select input CSV files",
    filetypes=[("CSV Files", "*.csv")]
)

# Read input CSV files into Pandas DataFrame
df_list = []
for file in input_files:
    df = pd.read_csv(file)
    df_list.append(df)

# Concatenate DataFrames into single DataFrame
concat_df = pd.concat(df_list)

# Ask user to specify output Excel filename
output_file = filedialog.asksaveasfilename(
    title="Save output Excel file",
    defaultextension=".xlsx",
    filetypes=[("Excel Files", "*.xlsx")]
)

# Write concatenated DataFrame to Excel file with specified filename
concat_df.to_excel(output_file, index=False)

print("Output written to", output_file)
