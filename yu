# Read data from your table
table_name = "your_database.your_table_name"
json_data = spark.table(table_name)

# Flatten the nested structure
flattened_data = json_data.select(
    "id",
    "name",
    expr("get_json_object(json_column, '$.child1.id')").alias("child1_id"),
    expr("get_json_object(json_column, '$.child1.name')").alias("child1_name"),
 
