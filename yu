# Import necessary libraries
import os
import pandas as pd

# Specify the mount point folder path
mount_point = "/mnt/your_mount_point"

# Function to recursively count files and calculate total size
def count_files_and_size(folder_path):
    total_files = 0
    total_size = 0

    # Use dbutils.fs.ls to get the list of files in a folder
    files = dbutils.fs.ls(folder_path)

    for file_info in files:
        total_files += 1
        total_size += file_info.size

    # Convert size to GB
    total_size_gb = total_size / (1024 ** 3)

    return total_files, total_size_gb

# Get a list of folders in the mount point
folders = dbutils.fs.ls(mount_point)

# Create lists to store data
folder_paths = []
file_counts = []
total_sizes_gb = []

# Iterate through each folder and count files and calculate size
for folder in folders:
    folder_path = folder.path
    file_count, total_size_gb = count_files_and_size(folder_path)
    
    folder_paths.append(folder_path)
    file_counts.append(file_count)
    total_sizes_gb.append(total_size_gb)

# Create a DataFrame
df = pd.DataFrame({
    'Folder': folder_paths,
    'File Count': file_counts,
    'Total Size (GB)': total_sizes_gb
})

# Display the DataFrame
display(df)
