from pyspark.sql import SparkSession

# Initialize a Spark session
spark = SparkSession.builder.appName("CreateTempTable").getOrCreate()

# Define the directory path
directory_path = "/mnt/your_directory"

# Read files with names containing "20230822" into a DataFrame
df = spark.read.option("basePath", directory_path).parquet(f"{directory_path}/*20230822*")

# Create a temporary table
temp_table_name = "temp_table_20230822"
df.createOrReplaceTempView(temp_table_name)

# Display the data in the temporary table
spark.sql(f"SELECT * FROM {temp_table_name}").show()

# Stop the Spark session
spark.stop()
