CREATE TABLE B AS
WITH RankedData AS (
    SELECT
        *,
        ROW_NUMBER() OVER (PARTITION BY quoteid ORDER BY sysd DESC) AS sysd_rank
    FROM A
)
SELECT * FROM RankedData
WHERE (sysd_rank = 1 AND sysd = 'Y') OR (sysd_rank = 1 AND sysd = 'N');
