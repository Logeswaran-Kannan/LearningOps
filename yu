# Import necessary libraries
import os

# Specify the mount point folder path
mount_point = "/mnt/your_mount_point"

# Function to recursively count files and calculate total size
def count_files_and_size(folder_path):
    total_files = 0
    total_size = 0

    # Use dbutils.fs.ls to get the list of files in a folder
    files = dbutils.fs.ls(folder_path)

    for file_info in files:
        file_path = file_info.path
        total_files += 1
        total_size += file_info.size

    return total_files, total_size

# Get a list of folders in the mount point
folders = dbutils.fs.ls(mount_point)

# Display header
print(f"{'Folder':<50} {'File Count':<15} {'Total Size (bytes)':<20}")

# Iterate through each folder and count files and calculate size
for folder in folders:
    folder_path = folder.path
    file_count, total_size = count_files_and_size(folder_path)
    print(f"{folder_path:<50} {file_count:<15} {total_size:<20}")
