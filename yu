from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName("JsonViewer").getOrCreate()

# Replace 'your_table' and 'column_name' with the actual table and column names
table_name = 'your_table'
column_name = 'column_name'

# Read the existing table
existing_df = spark.table(table_name)

# Show the first 10 rows of the JSON column without truncation
existing_df.select(column_name).show(10, truncate=False)

# Write the full JSON data to a new table
# Replace 'new_table' with the desired name for the new table
new_table_name = 'new_table'
existing_df.write.mode('overwrite').saveAsTable(new_table_name)

# Stop the Spark session
spark.stop()
