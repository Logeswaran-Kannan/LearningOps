import psycopg2
from psycopg2 import Error

# Database connection parameters
host = "your_host"
database = "your_database"
user = "your_user"
password = "your_password"
schema = "kingfisher"  # Specify the schema name

try:
    # Establishing the connection
    connection = psycopg2.connect(
        user=user,
        password=password,
        host=host,
        database=database
    )

    cursor = connection.cursor()

    # Query to retrieve table names and column names
    query = """
    SELECT table_name, column_name
    FROM information_schema.columns
    WHERE table_schema = %s AND column_name LIKE %s;
    """

    # Execute the query
    cursor.execute(query, (schema, '%date%'))

    # Fetch all rows
    tables_with_date_column = cursor.fetchall()

    # Print table names and column names containing 'date'
    for table in tables_with_date_column:
        print("Table Name:", table[0])
        print("Column Name:", table[1])
        print("\n")

except (Exception, Error) as error:
    print("Error while connecting to PostgreSQL", error)

finally:
    # Closing database connection.
    if connection:
        cursor.close()
        connection.close()
        print("PostgreSQL connection is closed")
