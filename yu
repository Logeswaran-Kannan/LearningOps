import os

def get_size(file_path):
    """
    Get the size of a file or directory recursively.
    """
    if os.path.isfile(file_path):
        return os.path.getsize(file_path)
    elif os.path.isdir(file_path):
        total_size = 0
        for root, dirs, files in os.walk(file_path):
            for file in files:
                file_path = os.path.join(root, file)
                total_size += os.path.getsize(file_path)
        return total_size
    else:
        return 0

def get_files_and_sizes(base_path):
    """
    Get a list of files and their sizes in a directory.
    """
    files_and_sizes = []
    for root, dirs, files in os.walk(base_path):
        for file in files:
            file_path = os.path.join(root, file)
            size_in_bytes = get_size(file_path)
            size_in_mb = size_in_bytes / (1024 * 1024)
            files_and_sizes.append((file_path, size_in_mb))
    return files_and_sizes

# Example usage: Provide the mnt path to your Databricks mount
mnt_path = "/mnt/your_mount_path"

files_and_sizes = get_files_and_sizes(mnt_path)

# Display the result
for file, size_mb in files_and_sizes:
    print(f"File: {file}, Size: {size_mb:.2f} MB")
