import requests

# Databricks cluster configuration
cluster_url = "https://<databricks-instance>.cloud.databricks.com"
token = "<databricks-access-token>"

# API endpoint for Databricks workspace
api_endpoint = f"{cluster_url}/api/2.0"

# Prepare the request headers with the authentication token
headers = {
    "Authorization": f"Bearer {token}",
    "Content-Type": "application/json"
}

# Send a GET request to the workspace API to get the user information
response = requests.get(f"{api_endpoint}/preview/scim/v2/Me", headers=headers)

# Check if the request was successful
if response.status_code == 200:
    user_info = response.json()
    print("User Information:")
    print(user_info)
else:
    print("Error connecting to Databricks:", response.text)
