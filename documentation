import requests
import json

# Azure Databricks cluster configuration
cluster_url = "https://<region>.azuredatabricks.net"
token = "<databricks-access-token>"

# API endpoint for Databricks jobs/runs
api_endpoint = f"{cluster_url}/api/2.0/jobs/runs/submit"

# Prepare the request headers with the authentication token
headers = {
    "Authorization": f"Bearer {token}",
    "Content-Type": "application/json"
}

# Prepare the request body with the code to execute
data = {
    "run_name": "Databricks Run",
    "existing_cluster_id": "<cluster-id>",  # Enter your cluster ID here
    "notebook_task": {
        "notebook_path": "/your-notebook-path",
        "base_parameters": {
            "param1": "value1",  # Optional: Provide any additional parameters needed
            "param2": "value2"
        }
    }
}

# Send the request to Databricks to execute the code
response = requests.post(api_endpoint, headers=headers, data=json.dumps(data))

# Check if the request was successful
if response.status_code == 200:
    run_id = response.json()["run_id"]
    print(f"Run submitted successfully. Run ID: {run_id}")
else:
    print("Error submitting run:", response.text)
    exit()
