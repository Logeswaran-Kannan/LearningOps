SELECT
    CURRENT_DATE AS LOAD_DATE,
    COUNT(DISTINCT TABLE_NAME_RESOLVED) AS TOTAL_TABLES,
    COUNT(*) AS TOTAL_COLUMNS,
    
    COUNT(DISTINCT CASE WHEN COMPARISON_RESULT = 'TABLE MISSING IN REPLICA' THEN TABLE_NAME_RESOLVED END) AS TABLES_ONLY_IN_ORACLE,
    COUNT(DISTINCT CASE WHEN COMPARISON_RESULT = 'TABLE MISSING IN ORACLE' THEN TABLE_NAME_RESOLVED END) AS TABLES_ONLY_IN_REPLICA,
    
    COUNT(CASE WHEN COMPARISON_RESULT = 'COLUMN MISSING IN REPLICA' THEN 1 END) AS COLUMNS_ONLY_IN_ORACLE,
    COUNT(CASE WHEN COMPARISON_RESULT = 'COLUMN MISSING IN ORACLE' THEN 1 END) AS COLUMNS_ONLY_IN_REPLICA,
    
    COUNT(CASE WHEN COMPARISON_RESULT = 'DATATYPE MISMATCH' THEN 1 END) AS DATATYPE_MISMATCH_COUNT,
    COUNT(CASE WHEN COMPARISON_RESULT = 'PRECISION OR SCALE MISMATCH' THEN 1 END) AS PRECISION_SCALE_MISMATCH_COUNT,
    
    COUNT(CASE WHEN COMPARISON_RESULT = 'MATCH' THEN 1 END) AS MATCH_COUNT

FROM ddl_comparison_table;
