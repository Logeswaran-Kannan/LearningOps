DO
$$
DECLARE
    table_list TEXT[] := ARRAY[
        'table1',
        'table2',
        'table3'  -- Add your actual table names here
    ];
    tbl_name TEXT;
    row_count BIGINT;
    loaded_tables INT := 0;
    not_loaded_tables INT := 0;
    table_exists BOOLEAN;
BEGIN
    FOREACH tbl_name IN ARRAY table_list
    LOOP
        -- Check if table exists in the public schema
        SELECT EXISTS (
            SELECT 1 FROM pg_tables 
            WHERE schemaname = 'public' AND tablename = tbl_name
        ) INTO table_exists;

        IF table_exists THEN
            EXECUTE format('SELECT count(*) FROM public.%I', tbl_name) INTO row_count;

            IF row_count > 0 THEN
                loaded_tables := loaded_tables + 1;
                RAISE NOTICE 'Table: %, Count: %, Status: LOADED', tbl_name, row_count;
            ELSE
                not_loaded_tables := not_loaded_tables + 1;
                RAISE NOTICE 'Table: %, Count: %, Status: NOT LOADED', tbl_name, row_count;
            END IF;
        ELSE
            RAISE NOTICE 'Table: % not found in schema public', tbl_name;
        END IF;
    END LOOP;

    -- Summary
    RAISE NOTICE 'Summary -> Loaded tables: %, Not loaded tables: %', loaded_tables, not_loaded_tables;
END;
$$;
