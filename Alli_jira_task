import requests
import json

# --- Configuration ---
workspace_url = "https://<your-databricks-instance>.databricks.com"
access_token = "<your_personal_access_token>"

headers = {
    "Authorization": f"Bearer {access_token}",
    "Content-Type": "application/json"
}

# --- Input ---
table_name = "core_tst_std001.ods_views.vw_policycenter_std001_current_pc_policy"
column_name = "policy_number"  # Replace with actual column

url = f"{workspace_url}/api/2.0/lineage-tracking/column-lineage"
payload = {
    "table_name": table_name,
    "column_name": column_name
}

# --- Send Request ---
response = requests.post(url, headers=headers, json=payload)

# --- Handle Response ---
if response.status_code == 200:
    data = response.json()
    print(f"✅ Downstream references for {column_name}:")
    for col in data.get("downstream_columns", []):
        print(f"- {col['column_name']}")
else:
    print(f"❌ API error {response.status_code}: {response.text}")
