jdbcHostname = "your_postgres_host"
jdbcPort = 5432
jdbcDatabase = "your_db_name"
jdbcUrl = f"jdbc:postgresql://{jdbcHostname}:{jdbcPort}/{jdbcDatabase}"

connectionProperties = {
  "user" : "your_username",
  "password" : "your_password",
  "driver" : "org.postgresql.Driver"
}

# Attempt to read a simple table
try:
    df = spark.read.jdbc(url=jdbcUrl, table="your_table_name", properties=connectionProperties)
    df.show()
    print("Connection successful and data read.")
except Exception as e:
    print(f"Failed to read from PostgreSQL: {e}")
