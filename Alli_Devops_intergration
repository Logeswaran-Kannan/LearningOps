def update_test_result(run_id, result_id, test_case_id, test_point_id, outcome):
    try:
        completed_datetime = datetime.utcnow().strftime('%Y-%m-%dT%H:%M:%SZ')
        patch_url = f"{devops_organization}/{project}/_apis/test/runs/{run_id}/results?api-version=7.1"
        patch_payload = [{
            "id": result_id,
            "testCase": { "id": str(test_case_id) },
            "testRun": { "id": str(run_id) },
            "testPoint": { "id": str(test_point_id) },
            "outcome": outcome,
            "state": "Completed",
            "completedDate": completed_datetime,
            "automatedTestType": "UnitTest",
            "automatedTestName": f"TestCase_{test_case_id}"
        }]
        response = requests.patch(patch_url, headers={**headers, 'Content-Type': 'application/json'}, json=patch_payload)
        response.raise_for_status()
        print(f"✅ Updated result for TestCase {test_case_id} to {outcome}")
    except Exception as e:
        print(f"❌ Error updating test result {result_id}: {e}")
