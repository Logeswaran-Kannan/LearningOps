The analysis was conducted to understand why the modified test data added in dim_employee and dim_contact_centre_emp tables is not producing the expected results in the dataset. During this investigation, we noticed that the tables were joined using the "staff_no," "valid from dttm," "valid to dttm," "Employee_Key," and "Agent_Key" fields, similar to the example provided below.

Unfortunately, we found that no output was generated for any of the agents. We identified two key factors contributing to this issue:

Difference in 'Valid from dttm' and 'valid to dttm' equivalent of '__START_AT' and '__END_AT' in the gold layer for dim_employee:

For initial records, the "__END_DT" field behaves slightly differently in the gold layer, which causes discrepancies in staff_no matching between dim_employee and dim_contact_centre_emp tables.

To address this issue for initial records, I made a modification. Specifically, I considered cases where the "__END_DT" field is null and treated them as "9999-12-31." This adjustment allows the records to match appropriately in the dim_contact_centre_emp table.

For incremental updates, we need Mahesh's input. In the legacy world, DIM_EMPLOYEE tables would end-date the previous record for the staff_no by one day less, but the gold layer behaves differently in this aspect, leading to discrepancies while joining goldpolicy.dim_employee with the dim_contact_centre_emp table. We will seek Mahesh's insights to resolve this part of the issue.

Uppercase/lowercase issue for Cost_Centre 'ISell' in the sample test data added:

There is an existing uppercase/lowercase inconsistency in the Cost_Centre field, particularly for 'ISell' values in the test data.
We have a fix in progress to address this inconsistency.
We kindly request your insight and guidance on the incremental updates for the staff_no issue, and we will continue working towards resolving the uppercase/lowercase inconsistency in the Cost_Centre field.

Thank you for your attention to these matters, and we look forward to further collaboration to address these issues effectively.
