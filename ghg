import os
import tkinter as tk
from tkinter import filedialog
import pandas as pd

# Open dialogue window to select input folder
root = tk.Tk()
root.withdraw()
input_folder = filedialog.askdirectory(title="Select Input Folder")

# Open dialogue window to select output folder
output_folder = filedialog.askdirectory(title="Select Output Folder")

# Get a list of Parquet files in the input folder
parquet_files = [file for file in os.listdir(input_folder) if file.endswith(".parquet")]

# Iterate over the Parquet files
for file in parquet_files:
    # Read Parquet file into a Pandas DataFrame
    parquet_path = os.path.join(input_folder, file)
    df = pd.read_parquet(parquet_path)
    
    # Convert DataFrame to CSV
    csv_filename = os.path.splitext(file)[0] + ".csv"
    csv_path = os.path.join(output_folder, csv_filename)
    df.to_csv(csv_path, index=False)

print("Conversion completed successfully.")
