agg = (
    agg
    .withColumn("table_name", F.lit(t))                # <-- REQUIRED for DQ
    .withColumn("run_date", F.col(DATE_COL))
    .withColumn("Is_sla_flag", F.when(F.col("total_records") == 0, 1).otherwise(0))
)
