WITH policy AS (
  SELECT QUOTE_MQS_QUOTE_LNK_KEY AS QUOTE_KEY,
         PROPOSERPOLICYHOLDER_PRN AS POLICY_HOLDER_PRN
  FROM core_tst.mqs.athn_mtr.dv_prsnl_quote_plhdr_rqst_mtr_athn_mqs_sat
),
driver AS (
  SELECT QUOTE_MQS_QUOTE_LNK_KEY AS QUOTE_KEY,
         DRIVER_PRN
  FROM core_tst.mqs.athn_mtr.dv_prsnl_quote_driver_rqst_mtr_athn_mqs_sat
)
SELECT p.QUOTE_KEY, p.POLICY_HOLDER_PRN, d.DRIVER_PRN
FROM policy p
JOIN driver d ON p.QUOTE_KEY = d.QUOTE_KEY
WHERE p.POLICY_HOLDER_PRN <> d.DRIVER_PRN;
