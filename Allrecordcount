try:
    spark.sql(f"TRUNCATE TABLE {target_table}")
except Exception as e:
    print(f"Table {target_table} not found. Creating it as a Delta table.")
    ddl_comparison_df.limit(0).write.format("delta").saveAsTable(target_table)
    spark.sql(f"TRUNCATE TABLE {target_table}")

# Load data into the table
ddl_comparison_df.write.mode("append").saveAsTable(target_table)

end_time = time.time()
print(f"DDL comparison completed in {round(end_time - start_time, 2)} seconds")
