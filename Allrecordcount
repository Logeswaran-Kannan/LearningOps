import requests
import base64

# === Required Jira Credentials ===
JIRA_EMAIL = "your-email@example.com"
JIRA_TOKEN = "your-jira-api-token"
JIRA_DOMAIN = "yourcompany.atlassian.net"  # No https://

# === Encode Auth for Basic Auth ===
auth_string = f"{JIRA_EMAIL}:{JIRA_TOKEN}"
auth_token = base64.b64encode(auth_string.encode()).decode()

headers = {
    "Authorization": f"Basic {auth_token}",
    "Content-Type": "application/json"
}

# === Test API Call ===
# We'll hit the "myself" endpoint to confirm credentials
test_url = f"https://{JIRA_DOMAIN}/rest/api/3/myself"

response = requests.get(test_url, headers=headers)

# === Check the result ===
if response.status_code == 200:
    user = response.json()
    print(f"✅ Jira connection successful. Authenticated as: {user['displayName']}")
else:
    print(f"❌ Jira connection failed. Status: {response.status_code}")
    print(response.text)
