import requests
from requests.auth import HTTPBasicAuth
import json

# === CONFIGURATION ===
jira_url = "https://your-domain.atlassian.net/rest/api/2/issue"
jira_username = "your-email@example.com"
jira_api_token = "your-api-token"  # Use API token for Atlassian cloud
auth = HTTPBasicAuth(jira_username, jira_api_token)

headers = {
    "Content-Type": "application/json"
}

# === JIRA ISSUE PAYLOAD ===
payload = {
    "fields": {
        "project": {
            "key": "BICOE"
        },
        "summary": "Automated test validation source against ODS",
        "description": "test",
        "issuetype": {
            "name": "Test"
        },
        "labels": ["AUTOMATED-SIT"],
        
        # Custom fields (update field IDs accordingly)
        "customfield_10010": "Automated_SIT",  # Test_type
        "customfield_10011": "Automated_SIT",  # Test_Repository_Path
        "customfield_10012": ["BICOE-7799"]     # Test Plans associated
    }
}

# === API CALL ===
response = requests.post(jira_url, auth=auth, headers=headers, json=payload)

# === RESULT HANDLING ===
if response.status_code == 201:
    issue_key = response.json()['key']
    print(f"✅ Test case created successfully. Test Case ID: {issue_key}")
else:
    print(f"❌ Failed to create test case: {response.status_code}")
    print(response.text)
