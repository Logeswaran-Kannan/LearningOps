import dlt
from pyspark.sql.functions import *
from pyspark.sql import SparkSession

# Define Source and Target Tables
source_table = "default.data_migration_validation_results"
target_table = "core_tst_sys9.dashboard_data_migration_results"

@dlt.table(
    name="dashboard_data_migration_results",
    comment="This table stores unique validation results for the data migration dashboard",
    table_properties={
        "quality": "gold"
    }
)
def create_dashboard_table():
    # Read source table
    df_source = spark.read.table(source_table)

    # Remove duplicates based on all columns
    df_unique = df_source.dropDuplicates()

    return df_unique
