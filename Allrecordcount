-- Set environment for CSV output
SET FEEDBACK OFF
SET HEADING ON
SET COLSEP ','
SET PAGESIZE 0
SET LINESIZE 1000
SET TRIMSPOOL ON
SET TERMOUT OFF
SET ECHO OFF

-- Cursor to generate CSV exports
BEGIN
  FOR t IN (
    SELECT table_name
    FROM all_tables
    WHERE owner = 'BCR'
    ORDER BY table_name
  ) LOOP
    -- Construct spool command
    DBMS_OUTPUT.PUT_LINE('SPOOL C:\exports\' || t.table_name || '.csv');
    DBMS_OUTPUT.PUT_LINE('SELECT * FROM BCR.' || t.table_name || ';');
    DBMS_OUTPUT.PUT_LINE('SPOOL OFF');
  END LOOP;
END;
/
