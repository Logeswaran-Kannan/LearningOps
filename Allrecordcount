try:
    spark.read.table(output_table)
    print(f"Overwriting output table {output_table}.")
    overwrite_mode = True
except AnalysisException:
    print(f"Creating output table {output_table}.")
    overwrite_mode = False
    spark.sql(f"""
        CREATE TABLE IF NOT EXISTS {output_table} (
            table_name STRING,
            src_database STRING,
            tgt_database STRING,
            src_vs_tgt_missing_columns STRING,
            tgt_vs_src_missing_columns STRING,
            src_count BIGINT,
            tgt_count BIGINT,
            src_vs_tgt_data_mismatch_count BIGINT,
            tgt_vs_src_data_mismatch_count BIGINT,
            null_diff_columns STRING,
            data_mismatch_columns STRING,
            status STRING,
            comment STRING,
            time_taken_seconds DOUBLE,
            source_sql STRING,
            target_sql STRING
        ) USING DELTA
    """)
